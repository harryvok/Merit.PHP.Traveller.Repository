var Picup={customURLScheme:'fileupload://new?referrername=Merit Traveller&referrerfavicon=http://traveller.merit.com.au/mt/images/favicon.png&purpose=Select an image to upload to Traveller.&debug=true&returnstatus=true&returnthumbnaildataurl=true&thumbnailsize=100&postimagefilename=iphone_upload&postimageparam=filedata&imageformat=jpg',windowname:'traveller',activeFileInput:null,currentHash:'',hashObserverId:null,callbackHandler:null,openFileWithId:function(picID){window.open(Picup.urlForOptions('view',{'picID':picID}),Picup.windowname);return false;},convertFileInput:function(inputOrInputId,options){var input=inputOrInputId;if(typeof(inputOrInputId)=='string'){input=document.getElementById(inputOrInputId);}
input.type='button';input.value="Choose Photo...";input.picupOptions=options;input.onclick=function(){Picup.activeFileInput=this;window.open(Picup.urlForOptions('new',this.picupOptions),Picup.windowname);if(Picup.callbackHandler){Picup.currentHash=window.location.hash;Picup.hashObserverId=setInterval('Picup.checkHash()',500);}};input.disabled=false;return false;},checkHash:function(){if(window.location.hash!=Picup.currentHash){clearInterval(Picup.hashObserverId);Picup.currentHash=window.location.hash;var hash=window.location.hash.replace(/^\#/,'');var paramKVs=hash.split('&');var paramHash={};var paramOutput=[];for(var p=0;p<paramKVs.length;p++){var kvp=paramKVs[p];var kv=kvp.replace('=','&').split('&');paramHash[kv[0]]=kv[1];}
Picup.callbackHandler(paramHash);}},urlForOptions:function(action,options){var url=Picup.customURLScheme+action+'?';var params=[];for(var param in options){params.push(param+'='+options[param]);}
var uploadURL=url+params.join('&');return uploadURL;},};